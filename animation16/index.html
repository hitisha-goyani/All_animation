<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <canvas id="impossibleCanvas"></canvas>
</body>
<script>
    const canvas = document.getElementById("impossibleCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let time = 0;

// Shape sides to morph through
const shapes = [3, 4, 5, 6];
let currentShape = 0;
let nextShape = 1;
let morphProgress = 0;

function lerp(a, b, t) {
  return a + (b - a) * t;
}

function drawShape(sides, radius) {
  const points = [];
  for (let i = 0; i < sides; i++) {
    const angle = (i / sides) * Math.PI * 2 - Math.PI / 2;
    points.push([Math.cos(angle) * radius, Math.sin(angle) * radius]);
  }
  return points;
}

function drawMorph() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;

  ctx.save();
  ctx.translate(centerX, centerY);
  ctx.rotate(time * 0.005);

  const currentPoints = drawShape(shapes[currentShape], 200);
  const nextPoints = drawShape(shapes[nextShape], 200);

  // Normalize lengths by repeating shorter array
  while (currentPoints.length < nextPoints.length) {
    currentPoints.push(...currentPoints);
  }
  while (nextPoints.length < currentPoints.length) {
    nextPoints.push(...nextPoints);
  }

  ctx.beginPath();
  for (let i = 0; i < currentPoints.length; i++) {
    const x = lerp(currentPoints[i][0], nextPoints[i][0], morphProgress);
    const y = lerp(currentPoints[i][1], nextPoints[i][1], morphProgress);
    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }
  ctx.closePath();

  ctx.strokeStyle = `hsl(${(time * 2) % 360}, 80%, 60%)`;
  ctx.lineWidth = 8;
  ctx.stroke();

  ctx.restore();

  morphProgress += 0.005;
  if (morphProgress >= 1) {
    morphProgress = 0;
    currentShape = nextShape;
    nextShape = (nextShape + 1) % shapes.length;
  }

  time++;
  requestAnimationFrame(drawMorph);
}

drawMorph();

window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

</script>
</html>